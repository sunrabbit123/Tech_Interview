# DB 관련 요모조모

## 목차

### ElasticSearch의 키워드 검색과 RDBMS에서 %LIKE% 검색의 차이점

<Detail>

RDBMS에서의 `%LIKE%` 검색은 이 글을 보는 대부분은 아시겠지만,
중간에 해당 단어가 들어간 것들만 나오도록 필터링을 한 것 입니다.

ElasticSearch에서의 검색은 `역색인(inverted index)` 방식을 이용합니다.

> `색인(Index)`은 키워드를 찾아보기 쉽도록 정렬 및 나열한 것 입니다.
> `역색인(Inverted Index)`은 키워드를 통해 문서를 찾아내는 방식입니다.

이러한 역색인 방식은 `검색 키워드`를 통해 보다 빨리 원하는 문서를 찾아낼 수 있게됩니다.

> `%LIKE%` 검색은 `Full Text Search`인 반면
> 역색인방식은 전처리가 있기에, 후에 검색속도가 빨라지는 형태다.

</Detail>

### RDMBS에서 INDEX가 어떻게 구성되어있는가?

<Detail>

    `Index`는 색인, 보통 책의 목차의 역할정도다.
    원하는 것이 있으면 보고 페이지(주소)를 따라가 열람 하는 것

    그러기에 테이블을 검색하는 속도나 성능이 향상됩니다.
    또한 데이터들이 정렬되어있기에 보다 편하게 가져올 수 있습니다.


    하지만 이러한 인덱스를 관리하기 위해서 추가 작업이 필요하며
    추가 저장공간이 필요하고, 잘못 사용하는 경우 오히려 검색 성능만 저하됩니다.

</Detail>

### RDB와 NoSQL의 차이점

<Detail>

RDB와 NoSQL의 대표적인 차이점으로 두가지를 꼽을 수 있다.

1. 관계의 유무
2. SQL 사용 유무

NoSQL의 의미는 non Relational 이라는 의미가 크다
RDB보다 덜 제한적인 일관성 모델의 데이터 저장 및 검색을 위한 환경을 제공해준다.

이 중 유명한 것은 MongoDB, Redis 등이 있다.

`MongoDB`는 문서지향적, `Redis`는 키-값의 형태를 띈다.

본론으로 돌아와 둘의 차이점에는 관계의 유무가 큰 영향을 끼친다.
`NoSQL`은 데이터 구조를 알 수 없으며, 확장 및 축소가 중요하다면 사용하는게 좋으며
데이터 구조가 명확하며, 명확한 스키마가 중요하다면 `RDB`를 사용하는 것이 좋다.

</Detail>

### 어트리뷰트가 굉장히 많은 테이블을 설계해야한다. 어떻게 설계할 것 인가?

<Detail>

1. Master - slave, 스토리지 사용, 카디널리티 기준 인덱싱 선정
2. 인덱싱 성능 검사
3. explain 사용

</Detail>

### 커버링 인덱스란?

<Detail>

사전적 의미로는 다음과 같다.

> 쿼리를 충족하는데 필요한 모든 데이터를 갖는 인덱스

그럼 이게 무엇이냐
쿼리에 쓰이는 `where`, `Group By`, `Order By`에 쓰이는 모든 컬럼들이 인덱스의 구성요소인 것 이다.

#### Clustered Key, Non Clustered Key

|               | 대상                                       |       제한       |
| :-----------: | :----------------------------------------- | :--------------: |
|   Clustered   | PK, 없다면 UK, 얘도 없다면 Hidden Key 생성 | 한 테이블에 하나 |
| Non Clustered | 일반적인 인덱스                            |    제한 없음     |

대충 DB에 있는 데이터에 접근 할 때 두가지 경우로 나뉜다.

1. `Index`로 접근 시 Non CLustered Key가 갖고 있는 실제 레코드 주소값(Clustered Key)을 이용하여 재조회
2. `PK`, 즉 Clustered Key로 접근 시, 즉시 데이터 블록에 접근

그러기에 우리는 `PK`를 이용하여 조회할 경우 빠르게 데이터를 받아볼 수 있다.

> MySQL에서는 Non-clustered Key에 Clustered Key가 항상 포함되어 있다.

#### 그래서 커버링인덱스는?

결론으로 돌아오자면, 커버링 인덱스는 재조회 단계가 없도록 인덱스들로만 쿼리문을 작성하는 것이다.

</Detail>
